updateR()
q()
q()
library(reshape2)
install.packages("reshape2")
install.packages("installr")
library(reshape2)
otu_L2_limited_ra$Genus <- rownames(otu_L2_limited_ra)
setwd("~/GitHub/abracadabra/patrick/")
metadata <- read.delim("~/GitHub/abracadabra/data/map/temp_map.txt",
header=T,
sep='\t',
check.names=F,
comment='')
otu <- read.table("~/GitHub/abracadabra/data/processed_tax/taxonomy_counts_s.txt",
comment="",
header=TRUE,
sep="\t",
as.is=TRUE,
check.names=F,
row=1)
level = 6 # to go to genus level
names_split <- strsplit(rownames(otu), ";")
# code abby supplied to make this work without Tonya's complicated version
# so skip from the collapse part here directly to plotting
otustrings <- sapply(names_split,function(x)paste(x[1:level],collapse = ";"))
otu_L2 <- rowsum(otu,otustrings)
# check counts per species before filtering
range(rowSums(otu_L2))
# what counts are in each person?
range(colSums(otu_L2))
# let's normalize our table!
# Divide each person's species count by the total counts for that person
otu_L2_ra <- sweep(otu_L2, 2, colSums(otu_L2), "/")
colSums(otu_L2_ra)
#Next up, drop species with low mean relative abundance
otu_L2_limited <- otu_L2[rowMeans(otu_L2_ra)>0.001,]
rowMeans(otu_L2_limited)
# renormalize for plottin
otu_L2_limited_ra <- sweep(otu_L2_limited, 2, colSums(otu_L2_limited), "/")
library(reshape2)
otu_L2_limited_ra$Genus <- rownames(otu_L2_limited_ra)
melted_otu <- melt(otu_L2_limited_ra)
colnames(melted_otu) <- c("Taxa","SampleID","RelativeAbundance")
#plotting
library(ggplot2)
```{r setup, include=FALSE, message = FALSE}
# Add packages used in knitting this document here:
require(rmarkdown)
install.packages("rmarkdown")
install.packages("ggplot2")
install.packages("dplyr")
install.packages("vegan","ape","tibble")
install.packages("vegan")
install.packages("ape")
install.packages("tibble")
